<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>GGgifts</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
body {
  margin:0;
  background:#0b0f18;
  font-family:Arial;
  color:white;
}

/* HEADER */
.header {
  height:70px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:0 15px;
  background:linear-gradient(90deg,#0f172a,#1e293b);
}

.logo {
  font-size:20px;
  font-weight:700;
}

.balance-box {
  display:flex;
  align-items:center;
  gap:8px;
  background:#1e293b;
  padding:8px 14px;
  border-radius:20px;
  font-weight:600;
}

.plus {
  background:#3b82f6;
  width:28px;
  height:28px;
  border-radius:50%;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:18px;
}

/* CASE GRID */
.content {
  padding:15px;
  padding-bottom:110px;
}

.cases {
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:16px;
}

.case {
  height:170px;
  border-radius:18px;
  background:#1e293b;
}

/* BOTTOM NAV */
.bottom {
  position:fixed;
  bottom:0;
  left:0;
  right:0;
  height:90px;
  background:#0f172a;
  display:flex;
  justify-content:space-around;
  align-items:center;
}

.nav {
  text-align:center;
  font-size:12px;
  color:#9ca3af;
}

.center-btn {
  width:70px;
  height:70px;
  background:#3b82f6;
  border-radius:50%;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:bold;
  font-size:14px;
  color:white;
}
</style>
</head>

<body>

<div class="header">
  <div class="logo">GGgifts</div>

  <div class="balance-box">
    ⭐ <span id="balance">0</span>
    <div class="plus" onclick="topUp()">+</div>
  </div>
</div>

<div class="content">
  <div class="cases">
    <div class="case"></div>
    <div class="case"></div>
    <div class="case"></div>
    <div class="case"></div>
  </div>
</div>

<div class="bottom">
  <div class="nav">Апгрейд</div>
  <div class="nav">Крафты</div>
  <div class="center-btn">Кейсы</div>
  <div class="nav">Друзья</div>
  <div class="nav">Профиль</div>
</div>

<script>
const tg = window.Telegram.WebApp;
tg.expand();

const user = tg.initDataUnsafe.user;

async function loadUser() {
  const r = await fetch("/api/getUser", {
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify({
      telegram_id: user.id
    })
  });

  const data = await r.json();
  document.getElementById("balance").innerText = data.balance;
}

async function topUp() {
  const amount = prompt("Введите количество звёзд");

  if(!amount) return;

  const r = await fetch("/api/pay", {
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify({ amount })
  });

  const data = await r.json();
  tg.openInvoice(data.invoice);
}

loadUser();
</script>

</body>
</html>
